PREFIX bdo: <http://purl.bdrc.io/ontology/core/>
PREFIX bdr: <http://purl.bdrc.io/resource/> 
PREFIX bf: <http://id.loc.gov/ontologies/bibframe/>
PREFIX dct: <http://purl.org/dc/terms/>
PREFIX foaf: <http://xmlns.com/foaf/0.1/>
PREFIX gist: <https://ontologies.semanticarts.com/gist/>
PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
PREFIX tol: <https://ontologies.treasuryoflives.org/tol/>
PREFIX tolx: <https://taxonomies.treasuryoflives.org/>
PREFIX told: <https://data.treasuryoflives.org/>
PREFIX xml: <http://www.w3.org/XML/1998/namespace>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>

# TOL ID
# Tradition Name
# Parent Tradition TOL ID

CONSTRUCT {
    ?tradition a tol:Tradition ;
    gist:name 
    .


}

FROM <file:person_2021-08-09.csv>

WHERE {

    BIND(tarql:expandPrefixedName(CONCAT("told:_Person_tol_", ?TOL_ID)) AS ?person)
    BIND(tarql:expandPrefixedName(CONCAT("bdr:_Person_bdrc_", ?TBRC_RID)) AS ?bdrcResource)

    BIND(IF(?Birth_year_approximate = "1", CONCAT(?Birth_year, " (approximate)"), ?Birth_year) AS ?birthYear) 
    # TODO for ?Birth_year_alternate, parse: "1679, 1672, 1673" and "1900/1902"
    # BIND(CONCAT(?Birth_year_alternate, " (alternate)") AS ?birthYearAlternate)
    BIND(tarql:expandPrefixedName(CONCAT("tolx:_Century_", REPLACE(REPLACE(?Birth_century, " ", "_"), "[()]", ""))) AS ?birthCentury) 
    

    BIND(IF(?Death_year_approximate = "1", CONCAT(?Death_year, " (approximate)"), ?Death_year) AS ?deathYear)
    # TODO for ?Death_year_alternate, parse: "1465 / 1486"grep " annd "1900/1902""
    # BIND(CONCAT(?Death_year_alternate, " (alternate)") AS ?deathYearAlternate) 
    BIND(tarql:expandPrefixedName(CONCAT("tolx:_Century_", REPLACE(REPLACE(?Death_century, " ", "_"), "[()]", ""))) AS ?deathCentury) 

    BIND(IF(?Gender = "M", tarql:expandPrefixedName("bdr:GenderMale"), IF(?Gender = "F", tarql:expandPrefixedName("bdr:GenderFemale"), ?blank)) AS ?gender) 

}
